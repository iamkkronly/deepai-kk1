<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kaustav Deepsearch AI - Ultra Beautiful</title> <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet"> <style>
     :root {
         /* Refined Color Palette - Softer & More Integrated */
         --primary-color: #5e35b1; /* A richer, deeper purple */
         --secondary-color: #7e57c2; /* A slightly lighter purple */
         --accent-color: #ff9800; /* A slightly softer orange/amber */
         --text-dark: #212529; /* Darker, more standard text color */
         --text-medium: #495057;
         --text-light: #adb5bd;
         --background-light: #f0f2f5; /* Very subtle grey background */
         --background-card: #ffffff;
         --border-color: #e9ecef; /* Soft border */
         --shadow-light: rgba(0, 0, 0, 0.07);
         --shadow-medium: rgba(0, 0, 0, 0.12);
         --shadow-strong: rgba(0, 0, 0, 0.2);
         --gradient-bg: linear-gradient(135deg, #e3f2fd 0%, #e8eaf6 100%); /* Even softer, cooler gradient */
         --gradient-button: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
         --gradient-button-hover: linear-gradient(45deg, var(--secondary-color), var(--primary-color));
     }

     body {
         font-family: 'Poppins', sans-serif;
         background: var(--gradient-bg);
         color: var(--text-dark);
         padding: 20px;
         display: flex;
         justify-content: center;
         align-items: flex-start;
         min-height: 100vh;
         margin: 0;
         line-height: 1.8; /* Increased line height for more air */
         position: relative;
         overflow-x: hidden;
         animation: fadeIn 0.9s ease-out; /* Slightly slower fade-in */
         perspective: 1200px; /* Increased perspective */
         transform-style: preserve-3d; /* Ensure children can have 3D */
     }

     @keyframes fadeIn {
         from {opacity: 0; transform: translateY(20px);} /* Fade in with slight upward movement */
         to {opacity: 1; transform: translateY(0);}
     }


     body::before {
         content: '';
         position: absolute;
         top: 0;
         left: 0;
         right: 0;
         bottom: 0;
         background-image: radial-gradient(rgba(94, 53, 177, 0.1) 1px, transparent 1px); /* Pattern using primary color with less opacity */
         background-size: 22px 22px; /* Slightly larger pattern cells */
         opacity: 0.08; /* Reduced opacity */
         z-index: -1;
         animation: moveGradient 50s linear infinite; /* Slower animation */
     }

     @keyframes moveGradient {
         0% {background-position: 0 0;}
         100% {background-position: 100% 100%;}
     }


     .container {
         background-color: var(--background-card);
         padding: 50px;
         border-radius: 35px;
         /* More refined shadow for perceived depth */
         box-shadow:
             0 18px 35px rgba(0,0,0,0.1),
             0 40px 80px rgba(0,0,0,0.15);
         max-width: 1000px;
         width: 100%;
         text-align: center;
         box-sizing: border-box;
         margin-top: 50px;
         margin-bottom: 50px;
         position: relative;
         z-index: 1;
         overflow: hidden;
         border: none; /* Removed main border, rely on shadow */
         animation: containerSlideIn 1s cubic-bezier(0.215, 0.610, 0.355, 1); /* Custom animation */
         transform-style: preserve-3d;
     }
      @keyframes containerSlideIn {
          0% { transform: translateZ(-200px) scale(0.9); opacity: 0; }
          100% { transform: translateZ(0) scale(1); opacity: 1; }
      }


     h1 {
         color: var(--primary-color);
         margin-bottom: 10px;
         font-weight: 700;
         font-size: 3em; /* Larger heading */
         text-shadow: 2px 3px 6px rgba(0,0,0,0.15); /* Softer, slightly larger text shadow */
         letter-spacing: -1.5px; /* Tighter */
     }

     .subtitle {
         color: var(--text-medium);
         margin-top: 0;
         margin-bottom: 60px; /* More space below */
         font-weight: 500; /* Medium weight */
         font-size: 1.4em;
         opacity: 0.9; /* Less faded */
     }

     .form-row {
         display: flex;
         gap: 40px; /* More space */
         margin-bottom: 45px; /* More space below */
         align-items: flex-start;
         flex-wrap: wrap;
     }

     .form-group {
         flex: 1;
         text-align: left;
         min-width: 220px; /* Increased min-width */
         display: flex;
         flex-direction: column;
     }

     .form-group.query-input {
         flex: 2;
         min-width: 350px; /* Increased min-width */
     }

     .form-controls {
         display: grid;
         grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); /* Adjusted min-width */
         gap: 30px;
         margin-bottom: 45px; /* More space */
     }

     label {
         font-weight: 600;
         display: block;
         margin-bottom: 10px; /* Slightly less space */
         color: var(--primary-color);
         font-size: 1.05em;
         transition: color 0.3s ease;
     }

     input[type="text"],
     select,
     textarea {
         padding: 18px 22px;
         font-size: 18px;
         border-radius: 18px; /* Slightly less rounded */
         border: 1px solid var(--border-color);
         width: 100%;
         box-sizing: border-box;
         transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease, transform 0.2s ease;
         background-color: var(--background-card);
         -webkit-appearance: none;
         -moz-appearance: none;
         appearance: none;
         /* Softer inner shadow */
         box-shadow: inset 0 1px 4px rgba(0,0,0,0.04);
         margin-bottom: 15px;
     }


     input[type="text"]:focus,
     select:focus,
     textarea:focus {
         border-color: var(--secondary-color);
         outline: none;
         /* Refined outer shadow */
         box-shadow: inset 0 1px 4px rgba(0,0,0,0.04),
                     0 0 18px rgba(126, 87, 194, 0.5); /* Shadow using secondary color */
         background-color: #ffffff;
         transform: translateZ(8px); /* Pop out more */
     }

     select {
         background-image: url('data:image/svg+xml;utf8,<svg fill="%235e35b1" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M7 10l5 5 5-5z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'); /* Custom dropdown arrow matching primary color */
         background-repeat: no-repeat;
         background-position: right 18px top 50%;
         background-size: 22px auto;
         padding-right: 50px;
     }

     input[type="file"] {
         display: block;
         width: 100%;
         padding: 16px 0;
         font-size: 17px;
         border-radius: 18px; /* Match inputs */
         border: 1px solid var(--border-color);
         box-sizing: border-box;
         background-color: var(--background-card);
         cursor: pointer;
         transition: border-color 0.3s ease, box-shadow 0.3s ease, background-color 0.3s ease, transform 0.2s ease;
         box-shadow: inset 0 1px 4px rgba(0,0,0,0.04); /* Match inputs */
         overflow: hidden;
         margin-bottom: 15px;
     }

     input[type="file"]::file-selector-button {
         padding: 14px 24px;
         margin-right: 20px;
         border: none;
         background: var(--gradient-button);
         color: white;
         border-radius: 15px;
         cursor: pointer;
         transition: background 0.3s ease, opacity 0.2s ease, transform 0.2s ease, box-shadow 0.3s ease;
         font-weight: 600;
         box-shadow: 0 6px 12px rgba(0,0,0,0.1); /* Slightly stronger shadow */
     }

     input[type="file"]::file-selector-button:hover {
         background: var(--gradient-button-hover);
         opacity: 1;
         transform: translateY(-5px) translateZ(6px); /* More lift and pop out */
         box-shadow: 0 10px 20px rgba(0,0,0,0.2); /* Stronger shadow */
     }
     input[type="file"]::file-selector-button:active {
         transform: translateY(-2px) translateZ(3px); /* Subtle press */
         box-shadow: 0 5px 10px rgba(0,0,0,0.1);
     }
      input[type="file"]:focus::file-selector-button {
         outline: none;
      }


     input[type="file"]:focus {
        border-color: var(--secondary-color);
        outline: none;
        box-shadow: inset 0 1px 4px rgba(0,0,0,0.04),
                    0 0 18px rgba(126, 87, 194, 0.5); /* Match input focus shadow */
        background-color: #ffffff;
        transform: translateZ(8px); /* Match input focus */
     }

     #uploadedImagePreview {
         display: none; /* Hidden by default */
         max-width: 100%;
         height: auto;
         margin-top: 15px;
         border-radius: 15px;
         border: 1px solid var(--border-color);
         box-shadow: 0 8px 20px rgba(0,0,0,0.12); /* Nicer shadow */
         transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease; /* Added opacity transition */
         object-fit: contain;
         will-change: transform, box-shadow; /* Optimize animation */
     }
     #uploadedImagePreview:hover {
         transform: scale(1.03) translateZ(5px); /* More scale and pop on hover */
         box-shadow: 0 12px 30px rgba(0,0,0,0.2);
     }


     button {
         padding: 18px 50px; /* Increased padding */
         margin: 35px 15px 25px 15px; /* More space */
         font-size: 20px;
         border-radius: 30px; /* More rounded */
         border: none;
         cursor: pointer;
         transition: background 0.4s ease, transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.4s ease; /* Bouncier transform */
         font-weight: 600;
         box-shadow: 0 12px 25px var(--shadow-medium); /* Stronger initial shadow */
         text-transform: uppercase;
         letter-spacing: 1.2px; /* More spacing */
         position: relative;
         overflow: hidden;
         isolation: isolate;
         transform-style: preserve-3d;
         will-change: transform, box-shadow; /* Optimize animation */
     }

     button::before {
         content: '';
         position: absolute;
         top: 0;
         left: -100%;
         width: 100%;
         height: 100%;
         background: rgba(255, 255, 255, 0.25); /* Brighter shimmer */
         transition: left 0.5s ease-in-out; /* Slower shimmer */
         z-index: -1;
     }

     button:hover::before {
         left: 100%;
     }


     button:hover {
         transform: translateY(-8px) translateZ(15px) rotateX(2deg); /* More pronounced lift, pop, and tilt */
         box-shadow: 0 20px 40px var(--shadow-strong); /* Much larger shadow on hover */
     }

     button:active {
         transform: translateY(-3px) translateZ(8px); /* More subtle press down */
         box-shadow: 0 10px 20px var(--shadow-medium); /* Reset shadow partially */
     }

     button:first-of-type {
         background: var(--gradient-button);
         color: white;
     }

     button:first-of-type:hover {
         background: var(--gradient-button-hover);
     }

     button:last-of-type {
         background-color: var(--border-color);
         color: var(--text-medium);
         box-shadow: 0 8px 18px rgba(0,0,0,0.08); /* Softer shadow for clear button */
     }

     button:last-of-type:hover {
         background-color: #d0d0d0;
         color: var(--text-dark);
         box-shadow: 0 10px 20px rgba(0,0,0,0.15);
     }

     .results {
         margin-top: 80px; /* More space */
         text-align: left;
         border-top: 1px solid var(--border-color);
         padding-top: 70px; /* More space */
         animation: resultsFadeIn 1s ease-out 0.8s forwards; /* Slower fade in with delay */
         opacity: 0;
         transform-style: preserve-3d;
     }
     @keyframes resultsFadeIn {
         from {opacity: 0; transform: translateY(30px);}
         to {opacity: 1; transform: translateY(0);}
     }


     .results h2 {
         color: var(--primary-color);
         margin-top: 0;
         margin-bottom: 40px; /* More space */
         font-weight: 700;
         font-size: 2.2em; /* Larger heading */
         border-bottom: 2px solid var(--border-color);
         padding-bottom: 15px;
         position: relative;
     }
      .results h2::after {
          content: '';
          position: absolute;
          bottom: -2px;
          left: 0;
          width: 100px; /* Wider underline */
          height: 3px; /* Thicker underline */
          background: var(--secondary-color);
          border-radius: 2px;
      }


     .results > div {
         background-color: var(--background-card);
         padding: 40px; /* More padding */
         border-radius: 25px;
         margin-bottom: 35px; /* Consistent spacing */
         border: none; /* Remove border, rely on shadow */
         /* More prominent shadow for result items */
         box-shadow: 0 10px 25px var(--shadow-medium);
         transition: box-shadow 0.3s ease, transform 0.3s ease; /* Increased transition duration */
         position: relative;
         overflow: hidden;
         animation: slideInResult 0.7s ease-out forwards; /* Slower, smoother animation */
         opacity: 0;
         transform-style: preserve-3d;
         will-change: transform, box-shadow; /* Optimize animation */
     }

     @keyframes slideInResult {
         from {transform: translateY(40px) translateZ(-10px) scale(0.96); opacity: 0;} /* Start further back, lower, slightly smaller */
         to {transform: translateY(0) translateZ(0px) scale(1); opacity: 1;}
     }

     /* Apply animation delay to subsequent results */
     .results > div:nth-child(3) { animation-delay: 0.15s; } /* Increased delay */
     .results > div:nth-child(4) { animation-delay: 0.3s; }
     .results > div:nth-child(5) { animation-delay: 0.45s; }
     .results > div:nth-child(6) { animation-delay: 0.6s; }
      .results > div:nth-child(7) { animation-delay: 0.75s; }
       .results > div:nth-child(8) { animation-delay: 0.9s; }


     .results > div:hover {
         box-shadow: 0 15px 35px var(--shadow-strong); /* Much larger shadow on hover */
         transform: translateY(-10px) translateZ(20px) rotateX(4deg); /* More pronounced lift, pop, and tilt */
     }


     .results a {
         color: var(--primary-color);
         text-decoration: none;
         font-weight: 600;
         font-size: 1.2em; /* Slightly larger link text */
         transition: color 0.3s ease, text-decoration 0.3s ease;
         display: block;
         margin-bottom: 8px;
         transform-style: preserve-3d;
     }

     .results a:hover {
         text-decoration: underline;
         color: var(--secondary-color);
     }

     .results p {
         color: var(--text-medium);
         margin-top: 12px; /* More space */
         line-height: 1.8;
         font-size: 1.05em;
         transform-style: preserve-3d;
     }

     hr {
         border: none;
         height: 2px; /* Thicker HR */
         background: linear-gradient(90deg, transparent 0%, var(--border-color) 50%, transparent 100%); /* Gradient HR */
         margin: 70px 0; /* More space */
     }

     .loading {
         font-weight: bold;
         margin-top: 60px; /* More space */
         font-size: 1.5em; /* Larger loading text */
         display: flex;
         align-items: center;
         justify-content: center;
         color: var(--accent-color);
         animation: pulse 1.5s infinite ease-in-out;
     }

     @keyframes pulse {
         0% {opacity: 1; transform: scale(1);}
         50% {opacity: 0.5; transform: scale(1.08);} /* More pronounced scale pulse */
         100% {opacity: 1; transform: scale(1);}
     }

     .loading .spinner {
         border: 7px solid rgba(255, 152, 0, 0.3); /* Spinner border using accent color with opacity */
         border-top: 7px solid var(--accent-color); /* Solid top border */
         border-radius: 50%;
         width: 40px; /* Larger spinner */
         height: 40px; /* Larger spinner */
         animation: spin 1s linear infinite;
         margin-right: 25px; /* More space */
         transform-style: preserve-3d;
     }

     @keyframes spin {
         0% { transform: rotateY(0deg) rotateX(0deg); }
         100% { transform: rotateY(360deg) rotateX(360deg); }
     }


     /* Custom Scrollbar Styles (for Webkit browsers like Chrome, Safari) */
     ::-webkit-scrollbar {
         width: 12px;
     }

     ::-webkit-scrollbar-track {
         background: var(--background-light);
         border-radius: 10px;
     }

     ::-webkit-scrollbar-thumb {
         background: var(--secondary-color);
         border-radius: 10px;
         border: 3px solid var(--background-light);
     }

     ::-webkit-scrollbar-thumb:hover {
         background: var(--primary-color);
     }


     /* Responsive adjustments */
     @media (max-width: 992px) {
         body { perspective: 900px; animation: fadeIn 0.8s ease-out; } /* Adjust perspective and animation */
          @keyframes fadeIn {
              from {opacity: 0; transform: translateY(15px);}
              to {opacity: 1; transform: translateY(0);}
          }
         .container {
             padding: 35px;
             border-radius: 25px;
             margin-top: 35px;
             margin-bottom: 35px;
             box-shadow: 0 12px 25px rgba(0,0,0,0.1), 0 25px 50px rgba(0,0,0,0.15); /* Adjusted shadow */
             animation: containerSlideIn 0.9s cubic-bezier(0.215, 0.610, 0.355, 1);
         }
          @keyframes containerSlideIn {
              0% { transform: translateZ(-150px) scale(0.95); opacity: 0; }
              100% { transform: translateZ(0) scale(1); opacity: 1; }
          }

         h1 { font-size: 2.5em; letter-spacing: -1px; }
         .subtitle { font-size: 1.2em; margin-bottom: 40px; }
         .form-row { gap: 30px; margin-bottom: 35px; align-items: flex-start; }
         .form-group.query-input { min-width: 300px; }
         .form-group { min-width: 200px; }
         .form-controls { grid-template-columns: repeat(auto-fit, minmax(220px, 1fr)); gap: 25px; margin-bottom: 35px; }
         label { margin-bottom: 8px; font-size: 1em; }
         input[type="text"], select, textarea, input[type="file"] { font-size: 17px; padding: 16px 20px; border-radius: 16px; margin-bottom: 12px; box-shadow: inset 0 1px 4px rgba(0,0,0,0.04);}
         input[type="text"]:focus, select:focus, textarea:focus, input[type="file"]:focus { box-shadow: inset 0 1px 4px rgba(0,0,0,0.04), 0 0 15px rgba(126, 87, 194, 0.45); transform: translateZ(6px); }

         select { padding-right: 45px; background-position: right 15px top 50%; background-size: 20px auto; }
         input[type="file"] { padding: 14px 0; margin-bottom: 12px; }
         input[type="file"]::file-selector-button { padding: 12px 20px; margin-right: 15px; border-radius: 12px; box-shadow: 0 5px 10px rgba(0,0,0,0.1); }
         input[type="file"]::file-selector-button:hover { transform: translateY(-4px) translateZ(5px); box-shadow: 0 8px 16px rgba(0,0,0,0.18); }
         input[type="file"]::file-selector-button:active { transform: translateY(-1px) translateZ(2px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

         #uploadedImagePreview { margin-top: 12px; border-radius: 12px; box-shadow: 0 6px 15px rgba(0,0,0,0.1); }
         #uploadedImagePreview:hover { transform: scale(1.02) translateZ(4px); box-shadow: 0 9px 22px rgba(0,0,0,0.18); }


         button { font-size: 17px; padding: 16px 40px; margin: 25px 10px 20px 10px; border-radius: 25px; letter-spacing: 1px; box-shadow: 0 10px 20px var(--shadow-medium); }
         button:hover { transform: translateY(-7px) translateZ(12px) rotateX(2deg); box-shadow: 0 15px 30px var(--shadow-strong); }
         button:active { transform: translateY(-3px) translateZ(6px); box-shadow: 0 8px 16px var(--shadow-medium); }
         button:last-of-type:hover { box-shadow: 0 10px 20px rgba(0,0,0,0.12); }


         .results { margin-top: 60px; padding-top: 50px; animation: resultsFadeIn 0.9s ease-out 0.7s forwards; }
          @keyframes resultsFadeIn {
              from {opacity: 0; transform: translateY(20px);}
              to {opacity: 1; transform: translateY(0);}
          }
         .results h2 { font-size: 2em; margin-bottom: 30px; padding-bottom: 12px; }
         .results h2::after { width: 80px; height: 3px;}

         .results > div { padding: 30px; border-radius: 20px; margin-bottom: 30px; box-shadow: 0 8px 20px var(--shadow-medium); animation: slideInResult 0.6s ease-out forwards; }
         @keyframes slideInResult {
             from {transform: translateY(30px) translateZ(-8px) scale(0.97); opacity: 0;}
             to {transform: translateY(0) translateZ(0px) scale(1); opacity: 1;}
         }
         .results > div:nth-child(3) { animation-delay: 0.12s; }
         .results > div:nth-child(4) { animation-delay: 0.24s; }
         .results > div:nth-child(5) { animation-delay: 0.36s; }
         .results > div:nth-child(6) { animation-delay: 0.48s; }
         .results > div:nth-child(7) { animation-delay: 0.6s; }
         .results > div:nth-child(8) { animation-delay: 0.72s; }


         .results > div:hover { box-shadow: 0 12px 30px var(--shadow-strong); transform: translateY(-8px) translateZ(15px) rotateX(3deg); }

         .results a { font-size: 1.1em; }
         .results p { font-size: 1em; margin-top: 10px; }
         hr { margin: 50px 0; height: 2px; }
         .loading { font-size: 1.3em; margin-top: 40px; }
         .loading .spinner { width: 35px; height: 35px; border-width: 6px; margin-right: 20px; }
     }


     @media (max-width: 768px) { /* Added a breakpoint */
         .container { padding: 25px; border-radius: 20px; margin-top: 25px; margin-bottom: 25px; }
         h1 { font-size: 2.2em; letter-spacing: -0.5px; }
         .subtitle { font-size: 1.1em; margin-bottom: 30px; }
         .form-row { gap: 20px; margin-bottom: 25px; flex-direction: column; align-items: center;} /* Center items when stacked */
          .form-group, .form-group.query-input { width: 100%; min-width: auto; } /* Full width when stacked */

         .form-controls { grid-template-columns: 1fr; gap: 20px; margin-bottom: 25px; } /* Stack controls */

         input[type="text"], select, textarea, input[type="file"] { font-size: 16px; padding: 14px 18px; border-radius: 14px; margin-bottom: 10px; }
         select { padding-right: 40px; background-position: right 12px top 50%; background-size: 18px auto; }
         input[type="file"] { padding: 12px 0; margin-bottom: 10px; }
         input[type="file"]::file-selector-button { padding: 10px 16px; margin-right: 10px; border-radius: 10px; }

         #uploadedImagePreview { margin-top: 10px; border-radius: 10px; max-width: 80%; /* Limit image width in stacked view */ }


         button { font-size: 16px; padding: 14px 30px; margin: 20px 8px 15px 8px; border-radius: 20px; letter-spacing: 0.8px; box-shadow: 0 6px 12px var(--shadow-medium); }
         button:hover { transform: translateY(-5px) translateZ(8px); box-shadow: 0 8px 16px var(--shadow-strong); }
         button:active { transform: translateY(-2px) translateZ(4px); box-shadow: 0 4px 8px var(--shadow-medium); }
         button:last-of-type:hover { box-shadow: 0 6px 12px rgba(0,0,0,0.12); }


         .results { margin-top: 40px; padding-top: 30px; }
         .results h2 { font-size: 1.8em; margin-bottom: 25px; padding-bottom: 10px; }
         .results h2::after { width: 60px; height: 3px; }

         .results > div { padding: 25px; border-radius: 18px; margin-bottom: 25px; box-shadow: 0 5px 15px var(--shadow-medium); }
         .results > div:hover { box-shadow: 0 8px 20px var(--shadow-strong); transform: translateY(-6px) translateZ(10px) rotateX(2deg); }

         .results a { font-size: 1em; }
         .results p { font-size: 0.95em; margin-top: 8px; }
         hr { margin: 40px 0; height: 2px; }
         .loading { font-size: 1.2em; margin-top: 30px; }
         .loading .spinner { width: 30px; height: 30px; border-width: 5px; margin-right: 15px; }
     }


     @media (max-width: 576px) {
         body { padding: 10px; perspective: 500px; }
          @keyframes fadeIn {
              from {opacity: 0; transform: translateY(10px);}
              to {opacity: 1; transform: translateY(0);}
          }
         .container { padding: 15px; border-radius: 10px; margin-top: 15px; margin-bottom: 15px; box-shadow: 0 5px 10px rgba(0,0,0,0.1), 0 10px 20px rgba(0,0,0,0.15); }
          @keyframes containerSlideIn {
              0% { transform: translateZ(-100px) scale(0.98); opacity: 0; }
              100% { transform: translateZ(0) scale(1); opacity: 1; }
          }
         h1 { font-size: 2em; letter-spacing: -0.5px; }
         .subtitle { font-size: 0.9em; margin-bottom: 20px; }
         .form-row { gap: 15px; margin-bottom: 20px; }
         .form-controls { gap: 15px; margin-bottom: 20px; }
         label { font-size: 0.95em; margin-bottom: 6px; }
         input[type="text"], select, textarea, input[type="file"] { font-size: 14px; padding: 10px 12px; border-radius: 10px; margin-bottom: 8px; box-shadow: inset 0 1px 3px rgba(0,0,0,0.03); }
          input[type="text"]:focus, select:focus, textarea:focus, input[type="file"]:focus { box-shadow: inset 0 1px 3px rgba(0,0,0,0.03), 0 0 12px rgba(126, 87, 194, 0.4); transform: translateZ(5px); }

         select { padding-right: 35px; background-position: right 10px top 50%; background-size: 16px auto; }
         input[type="file"] { padding: 8px 0; margin-bottom: 8px; }
         input[type="file"]::file-selector-button { padding: 8px 12px; margin-right: 8px; border-radius: 8px; font-size: 0.85em; box-shadow: 0 3px 6px rgba(0,0,0,0.08); }
         input[type="file"]::file-selector-button:hover { transform: translateY(-2px) translateZ(3px); box-shadow: 0 4px 8px rgba(0,0,0,0.15); }
         input[type="file']::file-selector-button:active { transform: translateY(-1px) translateZ(1px); box-shadow: 0 2px 4px rgba(0,0,0,0.05); }

         #uploadedImagePreview { margin-top: 8px; border-radius: 8px; max-width: 90%; }


         button { font-size: 14px; padding: 10px 25px; margin: 15px 5px 10px 5px; border-radius: 18px; letter-spacing: 0.5px; box-shadow: 0 5px 10px var(--shadow-medium); }
         button:hover { transform: translateY(-3px) translateZ(5px); box-shadow: 0 6px 12px var(--shadow-strong); }
         button:active { transform: translateY(-1px) translateZ(2px); box-shadow: 0 3px 6px var(--shadow-medium); }
         button:last-of-type:hover { box-shadow: 0 5px 10px rgba(0,0,0,0.1); }


         .results { margin-top: 30px; padding-top: 25px; animation: resultsFadeIn 0.8s ease-out 0.6s forwards; }
         @keyframes resultsFadeIn {
             from {opacity: 0; transform: translateY(15px);}
             to {opacity: 1; transform: translateY(0);}
         }
         .results h2 { font-size: 1.6em; margin-bottom: 20px; padding-bottom: 8px; }
         .results h2::after { width: 50px; height: 2px; }

         .results > div { padding: 20px; border-radius: 15px; margin-bottom: 20px; box-shadow: 0 4px 12px var(--shadow-medium); animation: slideInResult 0.5s ease-out forwards; }
         @keyframes slideInResult {
             from {transform: translateY(25px) translateZ(-5px) scale(0.98); opacity: 0;}
             to {transform: translateY(0) translateZ(0) scale(1); opacity: 1;}
         }
         .results > div:nth-child(3) { animation-delay: 0.1s; }
         .results > div:nth-child(4) { animation-delay: 0.2s; }
         .results > div:nth-child(5) { animation-delay: 0.3s; }


         .results > div:hover { box-shadow: 0 6px 15px var(--shadow-strong); transform: translateY(-4px) translateZ(6px) rotateX(1deg); }

         .results a { font-size: 0.95em; }
         .results p { font-size: 0.95em; margin-top: 6px; line-height: 1.7; }
         hr { margin: 30px 0; height: 1px; }
         .loading { font-size: 1.1em; margin-top: 20px; }
         .loading .spinner { width: 25px; height: 25px; border-width: 4px; margin-right: 10px; }
          @keyframes pulse {
              0% {opacity: 1; transform: scale(1);}
              50% {opacity: 0.6; transform: scale(1.05);}
              100% {opacity: 1; transform: scale(1);}
          }
     }

      /* Even Smaller Screens */
     @media (max-width: 400px) {
          body { perspective: 400px; }
         .container { padding: 10px; border-radius: 8px; margin-top: 10px; margin-bottom: 10px; }
         h1 { font-size: 1.8em; }
         .subtitle { font-size: 0.8em; margin-bottom: 15px; }
         .form-row { gap: 10px; margin-bottom: 15px; }
         .form-controls { gap: 10px; margin-bottom: 15px; }
         label { font-size: 0.9em; margin-bottom: 5px; }
         input[type="text"], select, textarea, input[type="file"] { font-size: 13px; padding: 8px 10px; border-radius: 8px; margin-bottom: 6px; }
         select { padding-right: 30px; background-position: right 8px top 50%; background-size: 14px auto; }
         input[type="file"] { padding: 6px 0; margin-bottom: 6px; }
         input[type="file"]::file-selector-button { padding: 6px 10px; margin-right: 6px; border-radius: 6px; font-size: 0.8em; }

         #uploadedImagePreview { margin-top: 6px; border-radius: 6px; max-width: 100%; } /* Allow full width */


         button { font-size: 13px; padding: 8px 20px; margin: 10px 3px 8px 3px; border-radius: 15px; letter-spacing: 0.3px; }
         .results { margin-top: 25px; padding-top: 20px; }
         .results h2 { font-size: 1.4em; margin-bottom: 15px; padding-bottom: 6px; }
         .results h2::after { width: 40px; height: 1px; }
         .results > div { padding: 15px; border-radius: 10px; margin-bottom: 15px; }
         .results a { font-size: 0.9em; }
         .results p { font-size: 0.9em; margin-top: 4px; line-height: 1.6; }
         hr { margin: 25px 0; height: 1px; }
         .loading { font-size: 1em; margin-top: 15px; }
         .loading .spinner { width: 20px; height: 20px; border-width: 3px; margin-right: 8px;}
     }


  </style>
</head>
<body>
    <div class="container">
        <h1>Kaustav Deepsearch AI</h1>
        <p class="subtitle">Powered by Kaustav AI - The Fastest AI in the World</p>

        <div class="form-row">
            <div class="form-group query-input">
                <label for="query">Search Query:</label>
                <input type="text" id="query" placeholder="Enter your topic or question...">
            </div>
            <div class="form-group">
                <label for="imageInput">Upload Image (Optional):</label>
                <input type="file" id="imageInput" accept="image/*">
                <img id="uploadedImagePreview" src="#" alt="Image Preview"/>
            </div>
        </div>

        <div class="form-controls">
            <div class="form-group">
                <label for="language">Language:</label>
                <select id="language">
                    <option value="English">English</option>
                    <option value="Hindi">Hindi</option>
                    <option value="Bengali">Bengali</option>
                    <option value="Tamil">Tamil</option>
                    <option value="Telugu">Telugu</option>
                    <option value="Urdu">Urdu</option>
                    <option value="Gujarati">Gujarati</option>
                    <option value="Spanish">Spanish</option>
                    <option value="French">French</option>
                    <option value="German">German</option>
                     <option value="Marathi">Marathi</option>
                     <option value="Kannada">Kannada</option>
                     <option value="Malayalam">Malayalam</option>
                </select>
            </div>

            <div class="form-group">
                <label for="wordLimit">Max Summary Length:</label>
                <select id="wordLimit">
                    <option value="500">500 words</option>
                    <option value="1000">1000 words</option>
                    <option value="5000">5000 words</option>
                    <option value="10000">10000 words</option>
                    <option value="20000">20000 words</option>
                    <option value="40000">40000 words</option>
                    <option value="60000">60000 words</option>
                    <option value="80000">80000 words</option>
                </select>
            </div>

            <div class="form-group">
                <label for="tone">Summary Tone:</label>
                <select id="tone">
                    <option value="neutral">Neutral</option>
                    <option value="informal">Informal</option>
                    <option value="formal">Formal</option>
                    <option value="funny">Funny</option>
                    <option value="technical">Technical</option>
                    <option value="friendly">Friendly</option>
                    <option value="professional">Professional</option>
                </select>
            </div>

            <div class="form-group">
                <label for="format">Summary Format:</label>
                <select id="format">
                    <option value="paragraph">Paragraph</option>
                    <option value="bullets">Bullet Points</option>
                    <option value="numbered">Numbered List</option>
                    <option value="question-answer">Question/Answer</option>
                </select>
            </div>
        </div>

        <button onclick="startDeepSearch()">Start DeepSearch</button>
        <button onclick="clearResults()">Clear</button>

        <div class="loading" id="loading" style="display: none;">
            <div class="spinner"></div>
            <span id="loading-text">Loading...</span>
        </div>
        <div class="results" id="results"></div>
    </div>

    <script>
        // ⚠️ WARNING: Hardcoding API keys here is INSECURE. Use a backend proxy in production. ⚠️
        const GOOGLE_API_KEY = "AIzaSyCrV8RJ-kUj-LCxbqfB1QMa6RsPQ4bM80Y"; // Google Custom Search API Key
        const SEARCH_ENGINE_ID = "735baae6a3cee4779"; // Google Custom Search Engine ID
        const GEMINI_API_KEY = "AIzaSyAUS24UaK5kfxrfuUCue5zmyX3n3yD7Yek"; // Gemini 1.5 Flash API Key

        // Get reference to the image preview element
        const uploadedImagePreview = document.getElementById("uploadedImagePreview");
         // Ensure it's hidden on initial load
         uploadedImagePreview.style.display = "none";


        // Helper function to read file as Data URL (Base64)
        function readFileAsDataURL(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (event) => resolve(event.target.result);
                reader.onerror = (error) => reject(error);
                reader.readAsDataURL(file);
            });
        }


        async function startDeepSearch() {
            const query = document.getElementById("query").value.trim();
            const imageInput = document.getElementById("imageInput");
            const selectedFile = imageInput.files[0]; // Get the selected file
            const selectedLang = document.getElementById("language").value;
            const wordLimit = parseInt(document.getElementById("wordLimit").value);
            const tone = document.getElementById("tone").value;
            const format = document.getElementById("format").value;

            // Validation: Search Query is mandatory if no image is provided
            if (!query && !selectedFile) {
                alert("Bhai, search query ya image toh de!");
                return;
            }

            // Check if API keys are placeholders
             if (GOOGLE_API_KEY === "YOUR_GOOGLE_API_KEY" || SEARCH_ENGINE_ID === "YOUR_SEARCH_ENGINE_ID" || GEMINI_API_KEY === "YOUR_GEMINI_API_KEY") {
                 alert("Please replace the placeholder API keys and Search Engine ID in the script with your actual credentials.");
                 // Do NOT return here, allow fetching if keys are correct but user missed changing them
                 // return; // <-- Keep this commented out unless you want to strictly enforce changing placeholders
             }


            const loading = document.getElementById("loading");
            const loadingText = document.getElementById("loading-text");
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = ""; // Clear previous results

            let combinedText = "";
            let googleResultsHTML = ""; // To store Google results HTML
            let promptParts = []; // Array to hold parts for the Gemini prompt (text, image)

            try {
                 // Step 1: Handle Image Input (if any)
                if (selectedFile) {
                    loadingText.innerText = "Reading image...";
                    loading.style.display = "flex";

                    try {
                         const dataUrl = await readFileAsDataURL(selectedFile);

                         // Display the image preview
                         uploadedImagePreview.src = dataUrl;
                         uploadedImagePreview.style.display = "block";
                         uploadedImagePreview.style.opacity = 0; // Start hidden for fade-in
                         setTimeout(() => { uploadedImagePreview.style.opacity = 1; }, 50); // Fade in

                         // Split data URL to get MIME type and base64 data
                         const [meta, base64Data] = dataUrl.split(',');
                         const mimeTypeMatch = meta.match(/data:(.*?);base64/);
                         const mimeType = mimeTypeMatch ? mimeTypeMatch[1] : '';

                         if (!mimeType.startsWith('image/')) {
                              throw new Error("Selected file is not an image.");
                         }

                         promptParts.push({
                             inline_data: {
                                 mime_type: mimeType,
                                 data: base64Data
                             }
                         });

                    } catch (error) {
                         console.error("Error reading image:", error);
                         alert("Error reading image file. Please try another image.");
                         loading.style.display = "none";
                         // Clear preview if there was an error
                         uploadedImagePreview.src = "#";
                         uploadedImagePreview.style.opacity = 0;
                         setTimeout(() => { uploadedImagePreview.style.display = "none"; }, 300);
                         return;
                    }
                } else {
                    // If no image is selected, clear any previous preview
                    uploadedImagePreview.src = "#";
                    uploadedImagePreview.style.opacity = 0;
                    setTimeout(() => { uploadedImagePreview.style.display = "none"; }, 300);
                }

                 // Step 2: Handle Text Query & Google Search (Only if query is provided)
                 if (query) {
                     loadingText.innerText = `Google search in progress...`;
                     loading.style.display = "flex";

                     const googleData = await fetchGoogle(query);

                     if (googleData.items && googleData.items.length > 0) {
                         googleResultsHTML += `<h2>Google Search Results:</h2>`;
                         googleData.items.forEach(item => {
                             googleResultsHTML += `
                                 <div>
                                   <a href="${item.link}" target="_blank"><strong>${item.title}</strong></a>
                                   <p>${item.snippet}</p>
                                 </div>
                             `;
                             combinedText += `${item.title}\n${item.snippet}\n${item.link}\n\n`;
                         });
                     } else {
                          googleResultsHTML += `<h2>Google Search Results:</h2><p>No Google search results found.</p>`;
                     }
                 } else {
                     // Only add this message if we are NOT doing a Google search
                     if (selectedFile) { // If there's an image, indicate we're processing it without search
                         googleResultsHTML += `<h2>Google Search Results:</h2><p>No text query provided, skipping Google search. Analyzing image...</p>`;
                     } else { // Should be caught by validation, but fallback message
                          googleResultsHTML += `<h2>Google Search Results:</h2><p>No text query or image provided.</p>`;
                     }
                 }


                // Step 3: Generate AI Summary
                loadingText.innerText = `Generating AI summary...`;
                resultsDiv.style.opacity = 0;
                loading.style.display = "flex";

                resultsDiv.innerHTML += `<hr><h2>AI Summary (${selectedLang}, up to ${wordLimit} words):</h2>`;


                let basePromptText = `Summarize the key information based on the provided content. The summary should be in ${selectedLang} with a ${tone} tone and presented in ${format}. Keep the total summary under ${wordLimit} words.`;

                // Adjust prompt based on provided content (text and/or image)
                if (combinedText.length > 0 && selectedFile) {
                     basePromptText = `Considering the following web content:\n\n${combinedText}\n\nBased *only* on the provided text and image, summarize the key information relevant to the query "${query}". ${basePromptText}`;
                 } else if (combinedText.length > 0) {
                     basePromptText = `Considering the following web content:\n\n${combinedText}\n\nBased *only* on the provided text, summarize the key information relevant to the query "${query}". ${basePromptText}`;
                 } else if (selectedFile) {
                      basePromptText = `Based *only* on the provided image and the query "${query}", summarize the key information. ${basePromptText}`;
                 } else {
                      // This case should be rare due to validation, but fallback for query only
                       basePromptText = `Based on the query "${query}", summarize the key information. ${basePromptText}`;
                 }


                // Add the main text prompt to the parts array
                promptParts.unshift({ text: basePromptText });


                if (promptParts.length > 0) {
                     const summary = await fetchGeminiSummary(promptParts);
                     resultsDiv.innerHTML += `<p>${summary}</p>`;

                } else {
                    resultsDiv.innerHTML += `<p>Error: No prompt could be constructed.</p>`;
                }

                // Step 4: Display Google Results (if any)
                 // Always add the HR and Google section, even if empty, for consistent structure
                 resultsDiv.innerHTML += `<hr>`;
                 resultsDiv.innerHTML += googleResultsHTML;


                 // After adding content, trigger the animation
                 setTimeout(() => {
                     resultsDiv.style.opacity = 1;
                 }, 50);


            } catch (err) {
                console.error(err);
                alert("Kuch error aaya bhai!");
                resultsDiv.innerHTML += `<p style="color: red;">Error during search or summary generation: ${err.message}</p>`;
                 resultsDiv.style.opacity = 1;
            } finally {
                loading.style.display = "none";
            }
        }

        async function fetchGoogle(query) {
            if (!GOOGLE_API_KEY || !SEARCH_ENGINE_ID) {
                 console.error("Google API Key or Search Engine ID is missing."); // Log instead of throw if keys are placeholders
                 return { items: [] }; // Return empty results
            }
            const url = `https://www.googleapis.com/customsearch/v1?q=${encodeURIComponent(query)}&key=${GOOGLE_API_KEY}&cx=${SEARCH_ENGINE_ID}`;
            const res = await fetch(url);
            if (!res.ok) {
                 const errorDetail = await res.text();
                 throw new Error(`Google Search API error: ${res.status} ${res.statusText} - ${errorDetail}`);
            }
            return await res.json();
        }

        async function fetchGeminiSummary(promptParts) {
             if (!GEMINI_API_KEY) {
                 console.error("Gemini API Key is missing."); // Log instead of throw if key is placeholder
                 return "Gemini API Key is not set up."; // Return an error message
             }
             const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${GEMINI_API_KEY}`;

             const payload = {
                 contents: [{ parts: promptParts }],
                 generationConfig: {
                     maxOutputTokens: Math.min(parseInt(document.getElementById("wordLimit").value) * 2.5, 8192),
                     temperature: 0.7,
                     topP: 0.95,
                     topK: 40
                 }
             };

             const res = await fetch(url, {
                 method: "POST",
                 headers: { "Content-Type": "application/json" },
                 body: JSON.stringify(payload)
             });

             if (!res.ok) {
                 const errorDetail = await res.text();
                  throw new Error(`Gemini API error: ${res.status} ${res.statusText} - ${errorDetail}`);
             }

             const data = await res.json();
             if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
                 return data.candidates[0].content.parts[0].text;
             } else if (data.promptFeedback && data.promptFeedback.blockReason) {
                 return `Summary blocked due to safety policy: ${data.promptFeedback.blockReason}`;
             } else if (data.error) {
                 return `Gemini API Error: ${data.error.message}`;
             }
             else {
                  console.warn("Gemini API returned unexpected structure:", data);
                 return "Summary fail ho gaya bhai. (Unexpected API response)";
             }
        }

        function clearResults() {
            document.getElementById("query").value = "";
            document.getElementById("imageInput").value = null; // Clear file input

            // Clear and hide the image preview with fade out
            const uploadedImagePreview = document.getElementById("uploadedImagePreview");
            uploadedImagePreview.style.opacity = 0;
             uploadedImagePreview.src = "#"; // Clear src immediately for faster reset
            setTimeout(() => { uploadedImagePreview.style.display = "none"; }, 300);


            const resultsDiv = document.getElementById("results");
            resultsDiv.style.opacity = 0;
            setTimeout(() => {
                 resultsDiv.innerHTML = "";
                 document.getElementById("loading").style.display = "none";
                 document.getElementById("loading-text").innerText = "Loading...";
            }, 300);
        }
    </script>
</body>
</html>
